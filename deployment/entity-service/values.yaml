Name: "entityservice"

api:
  ingress:
    enabled: true
  domain: "beta.es.data61.xyz"
  domainProvider: "route53"

  imageRegistery: "quay.io/n1analytics"

  ## "IfNotPresent" or "Always"
  imagePullPolicy: "IfNotPresent"

  ## Expose the service to be accessed from outside the cluster (LoadBalancer service).
  ## or access it from within the cluster (ClusterIP service).
  ## Set the service type and the port to serve it.
  ## ref: http://kubernetes.io/docs/user-guide/services/
  ## Most likely if ingress is enabled, this should be ClusterIP,
  ## Otherwise LoadBalancer. Note you should manually adjust the timeout on
  ## an AWS ELB to 300+ seconds (from the default of 60).
  serviceType: "ClusterIP"
  servicePort: 80

  ## If using a load balancer on AWS you can optionally lock down access
  ## to a given IP range. Provide a list of IPs that are allowed via a
  ## security group.
  #serviceSourceRanges:
  #  - 130.155.157.0/24

  www:
    image: "entity-nginx"
    tag: "v1.3.0"
    memory: 256Mi
    cpu: 200m
    containerPort: 8851
  app:
    image: "entity-app"
    memory: 1Gi
    tag: "v1.7.0"
    debug: "false"
    containerPort: 8000
  Replicas: 1

workers:
  imageRegistery: "quay.io/n1analytics"
  image: "entity-app"
  tag: "v1.7.0"
  replicas: 1
  debug: "false"

  SMALL_COMPARISON_CHUNK_SIZE: "100000000"
  LARGE_COMPARISON_CHUNK_SIZE: "1000000000"

  # A minimum of say 100M because any smaller than
  # this isn't worth splitting across nodes.
  SMALL_JOB_SIZE: "100000000"
  LARGE_JOB_SIZE: "100000000000"

  # Default threshold for considering something a match
  MATCH_THRESHOLD: "0.95"

  # More than this many entities and we skip caching in redis
  MAX_CACHE_SIZE: "1000000"

  celery:
    PREFETCH_MULTIPLIER: "1"
    MAX_TASKS_PER_CHILD: "10"
    ACKS_LATE: "true"

  monitor:
    enabled: false

  ## https://kubernetes.io/docs/user-guide/compute-resources
  resources:
    requests:
      memory: 8Gi
      cpu: 2
    limits:
      memory: 32Gi
      cpu: 8

postgresql:
  # See available settings and defaults at:
  # https://github.com/kubernetes/charts/tree/master/stable/postgresql
  nameOverride: "db"
  postgresPassword: "x925SvzX6cuH"
  persistence:
    enabled: false
    storageClass: "slow"
    size: 20Gi
  imageTag: 9.6.2
  imagePullPolicy: IfNotPresent
  metrics:
    enabled: false
  resources:
    limits:
      memory: 8Gi
    requests:
      memory: 1Gi
      cpu: 100m

redis:
  # https://github.com/kubernetes/charts/tree/master/stable/redis#configuration
  redisPassword: "gOgRockEPtiN"
  persistence:
    enabled: true
    storageClass: "slow"
    size: "50Gi"
  metrics:
    enabled: false
  resources:
    requests:
      memory: 8Gi
      cpu: 200m
    limits:
      memory: 20Gi
      cpu: 1
  nameOverride: "redis"

minio:
  # https://github.com/kubernetes/charts/tree/master/stable/minio#configuration
  ## Can distribute the object store across multiple nodes...
  #mode: "distributed"
  serviceType: "ClusterIP"
  persistence:
    size: 100Gi
    storageClass: "slow"
  accessKey: "SNANDoWeruDenOCongsA"
  secretKey: "onimoUBRANeRNaLDeTyWrENTipHErYPrON"
  nameOverride: "minio"
